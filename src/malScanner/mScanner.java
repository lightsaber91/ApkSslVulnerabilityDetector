package malScanner;

import java.io.IOException;

import javax.xml.parsers.ParserConfigurationException;

import org.w3c.dom.Document;
import org.xml.sax.SAXException;

public class mScanner {
	//Counters for permission
	private int malignPermissionCounter;
	private int normalPermissionCounter;
	private int totalPermissionCounter;
	private float permissionScore;
	
	//Counters for intent filter action
	private int malignIfCounter;
	private int totalIfCounter;
	private float ifScore;
			
	
	public mScanner() {
		malignPermissionCounter = 0;
		normalPermissionCounter = 0;
		totalPermissionCounter = 0;
		permissionScore = 0f;
		malignIfCounter = 0;
		totalIfCounter = 0;
		ifScore = 0f;
	}

	public void scanDex(Document doc) throws ParserConfigurationException, SAXException, IOException {
		malwareDetector detector = new malwareDetector();
		detector.checkKeywords(this, doc);
		
		int benignPermission = totalPermissionCounter - normalPermissionCounter - malignPermissionCounter;
		permissionScore = (float) (malignPermissionCounter - benignPermission)/totalPermissionCounter;
		permissionScore += (float) normalPermissionCounter/totalPermissionCounter;
				
		ifScore = (float) malignIfCounter/totalIfCounter;		
	}
	
	public void setMalignPermissionCounter(int malignPermissionCounter) {
		this.malignPermissionCounter = malignPermissionCounter;
	}

	public void setNormalPermissionCounter(int normalPermissionCounter) {
		this.normalPermissionCounter = normalPermissionCounter;
	}

	public void setTotalPermissionCounter(int totalPermissionCounter) {
		this.totalPermissionCounter = totalPermissionCounter;
	}

	public float getPermissionScore() {
		return permissionScore;
	}

	public float getIfScore() {
		return ifScore;
	}

	public void setMalignIfCounter(int malignIfCounter) {
		this.malignIfCounter = malignIfCounter;
	}

	public void setTotalIfCounter(int totalIfCounter) {
		this.totalIfCounter = totalIfCounter;
	}

}
