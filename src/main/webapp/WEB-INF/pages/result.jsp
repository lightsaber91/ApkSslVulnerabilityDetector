<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<!DOCTYPE html>
<html lang="en">


<head>
<!-- Custom CSS -->
<link href="<c:url value="/resources/css/materialize.css"></c:url>"
	rel="stylesheet">
<link href="<c:url value="/resources/css/style.css"></c:url>"
	rel="stylesheet">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
<title>SSL Vulnerabilities Tool Detector - Results</title>

</head>

<body>
	<!-- Navbar -->
	<nav class="blue darken-4" role="navigation">

		<div class="nav-wrapper">
			<a href="home" class="brand-logo" style="padding-left: 2px">
				&nbsp SSL Vulnerabilities Tool Detector<span class="left"
				style="padding-left: 20px;"><i
					class="large mdi-navigation-arrow-back"></i></span>
			</a>
			<ul id="nav-mobile" class="right hide-on-med-and-down">
				<li><a href="sass.html">Source Code</a></li>
				<li><a href="components.html">Wiki</a></li>
				<li><a href="javascript.html">Informations</a></li>
			</ul>
		</div>
	</nav>


	<div class="section">
		<div class="row">
			<div class="col offset-l1 l10 s12 white z-depth-1">
				<article id="post-5"
					class="post-5 page type-page status-publish hentry">
					<div class="col l2 m4 s6">
						<img src="resources/img/sii.png" class="responsive-img" />
					</div>
					<div class="entry-content">
						<div class="col l10 m8 s12">
							<span class="grey-text"><h4
									class="grey-text darken-2 light">SSL Vulnerabilities
									Analysis Results</h4>
								<h5 class="grey-text darken-2 light">TrustManager</h5> <c:choose>
									<c:when test="${empty tmList}">
												No trust manager vulnerable for ${pk} &nbsp ${v}.
											</c:when>
									<c:otherwise>
										<table class="bordered" id="featuretable">
											<thead>
												<tr class="blue darken-4 white-text">
													<th data-field="id"><span class="white-text left">Package</span></th>
													<th data-field="free" class="white-text">Class</th>
													<th data-field="pro"><span class="white-text left">Result</span>
												</tr>
											</thead>
											<tbody>
												<c:forEach items="${tmList}" var="tm">
													<tr class="blue darken-4 white-text">
														<td class="featuretext ">${pk}&nbsp${v}</td>
														<td class="featuretext">${tm.classes}</td>
														<td class="featuretext">${tm.vuln}</td>
													</tr>
												</c:forEach>
											</tbody>

										</table>
									</c:otherwise>
								</c:choose>

								<h5 class="grey-text darken-2 light">HostName Verifier</h5> <c:choose>
									<c:when test="${empty hvList}">
												No hostname verifier vulnerable for ${pk} &nbsp version: &nbsp ${v}.
											</c:when>
									<c:otherwise>
										<table class="bordered" id="featuretable">
											<thead>
												<tr class="blue darken-4 white-text">
													<th data-field="id"><span class="white-text left">Package</span></th>
													<th data-field="free" class="white-text">Class</th>
													<th data-field="pro"><span class="white-text left">Result</span>
												</tr>
											</thead>
											<tbody>
												<c:forEach items="${hvList}" var="hv">
													<tr class="blue darken-4 white-text">
														<td class="featuretext ">${pk}&nbsp${v}</td>
														<td class="featuretext">${hv.classes}</td>
														<td class="featuretext">${hv.vuln}</td>
													</tr>
												</c:forEach>
											</tbody>

										</table>
									</c:otherwise>
								</c:choose>

								<h5 class="grey-text darken-2 light">Allow All HostName</h5> <c:choose>
									<c:when test="${empty aahList}">
												No allow all hostname verifier for ${pk} &nbsp version: &nbsp ${v}.
											</c:when>
									<c:otherwise>
										<table class="bordered" id="featuretable">
											<thead>
												<tr class="blue darken-4 white-text">
													<th data-field="id"><span class="white-text left">Package</span></th>
													<th data-field="free" class="white-text">Class</th>
												</tr>
											</thead>
											<tbody>
												<c:forEach items="${aahList}" var="al">
													<tr class="blue darken-4 white-text">
														<td class="featuretext ">${pk}&nbsp${v}</td>
														<td class="featuretext">${al.classes}</td>
													</tr>
												</c:forEach>
											</tbody>
										</table>
									</c:otherwise>
								</c:choose>

								<h5 class="grey-text darken-2 light">SSL Handler Error</h5> 
								<c:choose>
									<c:when test="${empty sshList}">
										No allow all hostname verifier for ${pk} &nbsp  version: &nbsp ${v}.
									</c:when>
									<c:otherwise>
										<table class="bordered" id="featuretable">
											<thead>
												<tr class="blue darken-4 white-text">
													<th data-field="id"><span class="white-text left">Package</span></th>
													<th data-field="free" class="white-text">Class</th>
													<th data-field="pro"><span class="white-text left">Result</span>
												</tr>
											</thead>
											<tbody>
												<c:forEach items="${sshList}" var="ssl">
													<tr class="blue darken-4 white-text">
														<td class="featuretext ">${pk}&nbsp${v}</td>
														<td class="featuretext">${ssl.classes}</td>
														<td class="featuretext">${ssl.vuln}</td>
													</tr>
												</c:forEach>
											</tbody>
										</table>
									</c:otherwise>
								</c:choose>
								<h5 class="grey-text darken-2 light">Allow All HostName</h5> <c:choose>
									<c:when test="${empty score}">
												Malware scan not performed for ${pk} &nbsp version: &nbsp ${v}.
											</c:when>
									<c:otherwise>
										<table class="bordered" id="featuretable">
											<thead>
												<tr class="blue darken-4 white-text">
													<th data-field="id"><span class="white-text left">Package</span></th>
													<th data-field="free" class="white-text">Permission Score</th>
													<th data-field="free" class="white-text">Intent Filter Score</th>
												</tr>
											</thead>
											<tbody>
												<tr class="blue darken-4 white-text">
													<td class="featuretext ">${pk}&nbsp${v}</td>
													<td class="featuretext">${score[0]}</td>
													<td class="featuretext">${score[1]}</td>
												</tr>
											</tbody>
										</table>
									</c:otherwise>
								</c:choose>
								<table class="bordered" id="featuretable">
									<thead><tr><th>&nbsp</th></tr></thead>
									<tbody></tbody>
								</table>
							</span>
						</div>
					</div>
				</article>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<footer class="page-footer orange">
		<div class="container">
			<div class="row">
				<div class="col s6">
					<h5 class="white-text">About us</h5>
					<p class="grey-text text-lighten-4">We are a team of two
						univerity students working on this project for the course of
						"Sicurezza Informatica e Internet" at the University of Roma
						TorVergata in the academic year 2015/2016.</p>
				</div>

				<div class="col s6">
					<h5 class="white-text">Contact us for all information at</h5>
					<ul>
						<li><a class="white-text" href="#!"><b>mattia.mancini.1991@gmail.com</b></a></li>
						<li><a class="white-text" href="#!"><b>martucci.simone.91@gmail.com</b></a></li>
					</ul>
				</div>
			</div>
		</div>
		<div class="footer-copyright">
			<div class="container">Made by Mattia Mancini and Simone
				Martucci</div>
		</div>
	</footer>

	<script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<script src="<c:url value="/resources/js/materialize.js"></c:url>"></script>
	<script src="<c:url value="/resources/js/init.js"></c:url>"></script>

	<script>
		function openUsage() {
			$('#modal1').openModal();
		}
		function openOptions() {
			$('#modal2').openModal();
		}
	</script>

</body>

</html>