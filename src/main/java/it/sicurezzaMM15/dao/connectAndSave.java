package it.sicurezzaMM15.dao;

import it.sicurezzaMM15.model.Apk;

import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class connectAndSave {
	
	private ApplicationContext context;
	private ApkJDBCTemplate apkJDBCTemplate;
	
	public connectAndSave() {
		context = new ClassPathXmlApplicationContext("Beans.xml");
		apkJDBCTemplate = (ApkJDBCTemplate)context.getBean("ApkJDBCTemplate");
	}

	public void saveOnDb(Apk app) {

		int id = apkJDBCTemplate.getAppId(app);
		if(id == -1) {
			apkJDBCTemplate.saveApp(app);
			id = apkJDBCTemplate.getAppId(app);
			apkJDBCTemplate.addTmVul(id, app.getTME());
			apkJDBCTemplate.addHnVul(id, app.getHVE());
			apkJDBCTemplate.addAllowAllVul(id, app.getAAE());
			apkJDBCTemplate.addSslVul(id, app.getSSLE());
		}
	}
	
}
