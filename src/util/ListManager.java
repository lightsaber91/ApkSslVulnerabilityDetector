package util;

import java.util.List;
/**
 * 
 * @author Simone Martucci
 * @author Mattia Mancini
 *
 * This class is used to manage the lists in
 * which we save all vulnerabilities found!
 */
public class ListManager {

	/**
	 * This function is used to remove copies contained in the list
	 * 
	 * @param classesList: the list containig the name of every files that contains vulnerabilties 
	 * @param vulLists: the list were are saved if that class is vulnerable or not
	 */
	public static void removeCopies(List<String> classesList, List<String> vulLists) {
		boolean[] exist = new boolean [classesList.size()];
		for(int i = 0; i < classesList.size(); i++) {
			exist[i] = false;
		}
		for(int i = 0; i < classesList.size(); i++) {
			boolean found = false;
			if(!exist[i]) {
				for(int j = 0; j < classesList.size(); j++) {
					if(i != j) {
						if(classesList.get(i).equals(classesList.get(j))) {
							found = true;
							exist[j] = true;
						}
					}
				}
				if(!found) {
					if(vulLists.get(i).equals(Const.VULNERABLE))
						vulLists.set(i, Const.V_NEVER_INVOKED);
					else
						vulLists.set(i, Const.M_NEVER_INVOKED);
				}
			}
		}
		for(int i = classesList.size(); i > 0; i--) {
			if(exist[i-1]) {
				classesList.remove(i-1);
				vulLists.remove(i-1);
			}
		}			
	}
	
	/**
	 * This method is used to modify the lists so the name of
	 * the classes containing found vulnerabilities will be
	 * printed as android package name
	 * 
	 * @param list: the list we need to modify
	 * @param src: the beginning directory
	 */
	public static void modifyPaths(List<String> list, String src) {
		if(!list.isEmpty()) {
			for(int i=0; i<list.size(); i++) {
				list.set(i, list.get(i).substring(src.length()+1, list.get(i).length() - ".smali".length()));
				list.set(i, list.get(i).replaceAll("/", "."));
			}
		}
	}
}
