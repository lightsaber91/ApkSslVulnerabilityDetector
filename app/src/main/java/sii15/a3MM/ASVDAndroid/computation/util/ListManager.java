package sii15.a3MM.ASVDAndroid.computation.util;

import java.io.File;
import java.util.List;
/**
 * 
 * @author Simone Martucci
 * @author Mattia Mancini
 *
 * This class is used to manage the lists in
 * which we save all vulnerabilities found!
 */
public class ListManager {

	/**
	 * This method is used to modify the lists so the name of
	 * the classes containing found vulnerabilities will be
	 * printed as android package name
	 * 
	 * @param list: the list we need to modify
	 * @param src: the beginning directory
	 */
	public static void modifyPaths(List<String> list, String src) {
		if(!list.isEmpty() && list != null) {
			for(int i=0; i<list.size(); i++) {
				list.set(i, list.get(i).substring(src.length(), list.get(i).length() - Const.SMALI.length()));
				if(list.get(i).startsWith(File.separator)) {
					list.set(i, list.get(i).substring(1));
				}
				list.set(i, list.get(i).replaceAll(File.separator, "."));
			}
		}
	}
}
