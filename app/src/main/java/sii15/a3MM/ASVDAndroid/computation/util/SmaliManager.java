package sii15.a3MM.ASVDAndroid.computation.util;

import java.io.File;
import java.util.List;

/**
 * 
 * @author Simone Martucci
 * @author Mattia Mancini
 *
 * This class is used to check for smali files
 * and in the end remove all these files
 *
 */
public class SmaliManager {

	/**
	 * Search all smali files in the specified directory
	 * and add these to the list
	 * 
	 * @param directory: directory were files are stored
	 * @param filelist: list were files will be saved
	 */
	public static void getSmaliFileList(File directory, List<File> filelist) {
		File[] files = directory.listFiles();
		if (files != null) {
			for (int i = 0; i < files.length; i++) {
				String fileName = files[i].getName();
				if (files[i].isDirectory()) {
					getSmaliFileList(files[i], filelist); 
				} else if(fileName.endsWith(Const.SMALI)){ 
					filelist.add(files[i]);
				} else {
					continue;
				}
			}

		}
	}
	
	/**
	 * Remove all smali files and directory
	 * 
	 * @param filelist: complete list of files
	 * @param dir: directory were files are stored
	 */
	public static void removeTmpFile(List<File> filelist, File dir) {
		if(filelist != null) {
			for(File file : filelist) {
				file.delete();
			}
		}
		File[] files = dir.listFiles();
	    for(int i=0; i<files.length; i++) {
	    	removeTmpFile(null, files[i]);
	    }
	    dir.delete();
	}
	
}
